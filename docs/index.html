<!DOCTYPE html>
<html>
<head>
  <title>Interactive Prolog with Tau Prolog</title>
  <script src="https://cdn.jsdelivr.net/npm/tau-prolog@0.3.2/modules/core.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    textarea, input { width: 100%; margin-top: 10px; }
    #output { white-space: pre-wrap; background: #f0f0f0; padding: 10px; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>Prolog in the Browser (Tau Prolog)</h1>

  <label for="program">Knowledge Base (Prolog facts/rules):</label>
  <textarea id="program" rows="6">likes(alice, pizza). likes(bob, sushi). likes(alice, chocolate).</textarea>

  <label for="query">Query:</label>
  <input id="query" type="text" placeholder="e.g., likes(alice, X).">

  <button id="run" onclick="runProlog()">Run Query</button>

  <h3>Output:</h3>
  <div id="output"></div>

  <script>
    function runProlog() {
      const program = document.getElementById("program").value;
      const query = document.getElementById("query").value;
      const output = document.getElementById("output");
      output.textContent = "";

      const session = pl.create();

      session.consult(program, {
        success: function () {
          session.query(query, {
            success: function () {
              session.answers(answer => {
                if (answer === false) {
                  output.textContent += "No more answers.\n";
                } else {
                  output.textContent += session.format_answer(answer) + "\n";
                }
              });
            },
            error: function (err) {
              output.textContent = "Query Error: " + err;
            }
          });
        },
        error: function (err) {
          output.textContent = "Program Error: " + err;
        }
      });
    }
  
    addEventListener('keydown', function (e) {
        if (e.key === 'Enter') {
            runProlog();
        }
    });
  </script>
</body>
</html>
